diff --git a/CMakeLists.txt b/CMakeLists.txt
index bdf61e4..a47ae92 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -3,19 +3,6 @@ PROJECT(minbif)
 
 set(CMAKE_MODULE_PATH ${CMAKE_CURRENT_SOURCE_DIR}/cmake-modules ${CMAKE_MODULE_PATH} )
 
-SET(CONF_NAME minbif.conf)
-SET(MOTD_NAME minbif.motd)
-
-IF(NOT MAN_PREFIX)
-	SET(MAN_PREFIX ${CMAKE_INSTALL_PREFIX}/share/man/man8/)
-ENDIF(NOT MAN_PREFIX)
-IF(NOT CONF_PREFIX)
-	SET(CONF_PREFIX ${CMAKE_INSTALL_PREFIX}/etc/minbif)
-ENDIF(NOT CONF_PREFIX)
-IF(NOT DOC_PREFIX)
-	SET(DOC_PREFIX ${CMAKE_INSTALL_PREFIX}/share/doc/minbif)
-ENDIF(NOT DOC_PREFIX)
-
 INCLUDE(FindPkgConfig)
 INCLUDE(CheckIncludeFiles)
 INCLUDE(CheckLibraryExists)
@@ -30,13 +17,26 @@ else (DEBUG)
 endif (DEBUG)
 
 PKG_CHECK_MODULES(PURPLE REQUIRED purple>=2.4)
-PKG_CHECK_MODULES(GTHREAD REQUIRED gthread-2.0)
 
 OPTION(ENABLE_MINBIF "Enable minbif compilation" ON)
 OPTION(ENABLE_PLUGIN "Enable plugin build" OFF)
-OPTION(ENABLE_PAM "Enable PAM support" OFF)
 
 IF(ENABLE_MINBIF)
+	SET(CONF_NAME minbif.conf)
+	SET(MOTD_NAME minbif.motd)
+
+	IF(NOT MAN_PREFIX)
+		SET(MAN_PREFIX ${CMAKE_INSTALL_PREFIX}/share/man/man8/)
+	ENDIF(NOT MAN_PREFIX)
+	IF(NOT CONF_PREFIX)
+		SET(CONF_PREFIX ${CMAKE_INSTALL_PREFIX}/etc/minbif)
+	ENDIF(NOT CONF_PREFIX)
+	IF(NOT DOC_PREFIX)
+		SET(DOC_PREFIX ${CMAKE_INSTALL_PREFIX}/share/doc/minbif)
+	ENDIF(NOT DOC_PREFIX)
+
+	PKG_CHECK_MODULES(GTHREAD REQUIRED gthread-2.0)
+
 	OPTION(ENABLE_IMLIB "Use imlib library" ON)
 	IF(ENABLE_IMLIB OR ENABLE_CACA)
 		PKG_CHECK_MODULES(IMLIB imlib2>=1.0)
@@ -78,23 +78,38 @@ IF(ENABLE_MINBIF)
 			MESSAGE(FATAL_ERROR "Dependencies for video were not met. Install gstreamer, farsight and libpurple>=2.6 first. Or to disable video, run 'make ENABLE_VIDEO=0'")
 		ENDIF(GSTREAMER_FOUND AND PURPLE_26_FOUND AND FARSIGHT_FOUND)
 	ENDIF(ENABLE_VIDEO)
+
+	INSTALL(FILES man/minbif.8
+		DESTINATION ${MAN_PREFIX})
+	INSTALL(FILES COPYING README
+		DESTINATION ${DOC_PREFIX})
+	INSTALL(DIRECTORY doc/
+		DESTINATION ${DOC_PREFIX})
+	INSTALL(FILES ${CONF_NAME} ${MOTD_NAME}
+		DESTINATION ${CONF_PREFIX})
+
+	OPTION(ENABLE_PAM "Enable PAM support" OFF)
+	IF (ENABLE_PAM)
+		find_package(PAM)
+
+		IF (PAM_FOUND)
+			SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -DHAVE_PAM")
+		ENDIF (PAM_FOUND)
+	ENDIF (ENABLE_PAM)
+	
+	OPTION(ENABLE_TLS "Enable TLS support" OFF)
+	IF (ENABLE_TLS)
+		PKG_CHECK_MODULES(GNUTLS REQUIRED "gnutls")
+		IF (GNUTLS_FOUND)
+			SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -DHAVE_TLS")
+		ENDIF (GNUTLS_FOUND)
+	ENDIF (ENABLE_TLS)
+
 ENDIF(ENABLE_MINBIF)
+
 IF(ENABLE_PLUGIN)
 	PKG_CHECK_MODULES(LIBXML REQUIRED libxml-2.0>=2.5)
 ENDIF(ENABLE_PLUGIN)
-IF (ENABLE_PAM)
-	find_package(PAM)
-
-	IF (PAM_FOUND)
-		SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -DHAVE_PAM")
-	ENDIF (PAM_FOUND)
-ENDIF (ENABLE_PAM)
-IF (ENABLE_TLS)
-	PKG_CHECK_MODULES(GNUTLS REQUIRED "gnutls")
-	IF (GNUTLS_FOUND)
-		SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -DHAVE_TLS")
-	ENDIF (GNUTLS_FOUND)
-ENDIF (ENABLE_TLS)
 
 INCLUDE_DIRECTORIES(${PURPLE_INCLUDE_DIRS} ${GTHREAD_INCLUDE_DIRS} ${CACA_INCLUDE_DIRS} ${IMLIB_INCLUDE_DIRS} ${GSTREAMER_INCLUDE_DIRS} ${FARSIGHT_INCLUDE_DIRS} ${LIBXML_INCLUDE_DIRS} ${PAM_INCLUDE_DIRS} ${GNUTLS_INCLUDE_DIRS} "src/")
 LINK_DIRECTORIES(${PURPLE_LIBRARY_DIRS} ${GTHREAD_LIBRARY_DIRS} ${CACA_LIBRARY_DIRS} ${IMLIB_LIBRARY_DIRS} ${GSTREAMER_LIBRARY_DIRS} ${FARSIGHT_LIBRARY_DIRS} ${LIBXML_LIBRARY_DIRS} ${GNUTLS_LIBRARY_DIRS})
@@ -113,11 +128,3 @@ ENDIF(ENABLE_PLUGIN)
 MESSAGE(STATUS "Using compiler ${CMAKE_CXX_COMPILER}")
 MESSAGE(STATUS "Build type: ${CMAKE_BUILD_TYPE}")
 
-INSTALL(FILES man/minbif.8
-	DESTINATION ${MAN_PREFIX})
-INSTALL(FILES COPYING README
-	DESTINATION ${DOC_PREFIX})
-INSTALL(DIRECTORY doc/
-	DESTINATION ${DOC_PREFIX})
-INSTALL(FILES ${CONF_NAME} ${MOTD_NAME}
-	DESTINATION ${CONF_PREFIX})
